# BLANK25 仕様書（v0.2 / 2026-02-09）

## 0. 目的

NAZOMATIC 内に、パネルを開きながら断片情報で謎解きを進めるゲーム **BLANK25** を追加する。

## 1. ゲーム概要

- 各問題には 1 枚の **問題画像**があり、その上に **25 枚のパネル（5×5）**が規則正しく配置される。
- パネルには **1〜25** の番号が書かれており、プレイヤーがタップするとパネルが消えて画像の一部が見える。
- プレイヤーは、開けた断片情報を元に答えを推測し、回答入力で正誤判定を行う。
- **スコア = 正解時点の未開封パネル数**。

## 2. コンテンツ（問題データ）

### 2.1 画像の配置

- 問題画像は `public/img/blank25` に配置する。
- 画像は **1×1 のサイズ感（正方形）** を想定し、UI 側で正方形に収まるように表示する。

### 2.2 問題マニフェスト JSON（必須）

問題の定義は JSON ファイルで管理する。**問題数・表示順・正解判定の受理語（表記ゆれ含む）**は JSON をソース・オブ・トゥルースにする。

- 配置（案）: `public/data/blank25/problems.json`
- この JSON に以下を定義できるようにする:
  - 問題の ID（URL/永続化用）
  - 画像ファイル名（`public/img/blank25` 配下）
  - リンクに表示する名前（一覧表示用）
  - 正解として受理する回答（複数・表記ゆれを含む。例: `タヌキ`, `たぬき`）

#### JSON スキーマ案

```json
{
  "problems": [
    {
      "imageFile": "1.jpg",
      "linkName": "第1問",
      "answers": ["たぬき", "タヌキ"]
    }
  ]
}
```

### 2.3 パネル数（固定）

- **BLANK25 の 25 はパネル枚数を表す**。
- パネルは常に 25 枚で、各問題画像の上に 5×5 で配置する。
- 問題数は将来的に **~100 問程度**まで増やす想定。

## 3. 画面仕様

### 3.1 `/blank25`（問題一覧）

問題数が増える前提のため、まずは一覧から問題を選べるようにする。

**構成**

- ヘッダー（既存共通 UI）
- タイトル・遊び方（短い説明）
- 問題リンク一覧（`problems.json` の `linkName` を表示）
  - クリックでゲーム画面へ遷移

### 3.2 `/blank25/[problemId]`（ゲーム画面）

**構成**

- ヘッダー（既存共通 UI）
- タイトル
- ステータスバー
  - 残りパネル数（例: `残り 23 / 25`）
  - 開封数（例: `開封 2`）
  - リセットボタン
  - 回答入力（テキスト）
  - 「判定」ボタン（正誤判定）
- 問題画像（正方形）
  - その上に 5×5 パネル（クリック可能）を重ねて配置

**パネルの状態**

- 未開封: 数字表示 + タップ可能
- 開封済み: 透明（クリック不可）として扱い、下の画像が見える

**タップ時挙動**

- タップしたパネルを消す（開封済みにする）
- スコア（残りパネル数）を更新する

### 3.3 正誤判定（回答）

- 入力された回答を `problems.json` の `answers` と照合し、正誤を表示する。
- 表記ゆれ対応のため、以下のいずれか（または両方）を採用する（実装方針）:
  1. JSON に表記ゆれを複数列挙（例: `タヌキ`, `たぬき`）
  2. 入力と答えを同一ルールで正規化して比較（例: 前後空白除去、全角/半角統一、ひらがな/カタカナ統一 など）

### 3.4 結果表示

- 正解になった時点でスコアを確定する
- スコア（残りパネル数）と、開封履歴（開けた番号一覧）を表示する
- クリップボードコピー / Web Share API による共有（任意）

## 4. 主要ユーザーフロー

1. `/blank25` を開く
2. 問題リンクをクリックして `/blank25/[problemId]` へ
3. パネルを選んで開封しながら推理する
4. 回答入力 → 判定 → 正解ならスコア確定

## 5. 状態管理（クライアント）

最低限保持する状態:

- `openedPanels: boolean[25]`（または `Set<number>`）
- `problemId: string`
- `problem: Problem`（画像・許容回答など）
- `answerInput: string`
- `isCorrect: boolean`

## 6. データ取得

- 問題一覧は `public/data/blank25/problems.json` を読み込む（`fetch` または静的 import）。
- 画像数の判断・問題数の判断は **JSON を基準**にするため、画像ディレクトリ列挙の Route 実装は不要。

## 7. ルーティング/導線追加（実装時）

- `src/app/(main)/blank25/page.tsx` を追加して `/blank25` を提供
- トップ導線:
  - `src/lib/json/features.json` にエントリ追加（順序が `Article index` と整合するように注意）
  - `Article`（JSON-LD）を追加する場合は index 管理も更新

## 8. 非機能要件

- **レスポンシブ**: モバイルで操作しやすいタップ領域（パネルは最小 44px 目安）
- **アクセシビリティ**: パネルは `button`、モーダルはフォーカストラップ、代替テキスト
- **パフォーマンス**: 画像は遅延読込（必要ならサムネイル/プリロード戦略）

## 9. 受け入れ条件（v0）

- `/blank25` に問題リンク一覧が表示され、クリックで各問題を開ける
- `/blank25/[problemId]` で問題画像の上に 1〜25 の 5×5 パネルが表示される
- パネルをタップするとそのパネルが消えて、画像の一部が見える
- 回答入力で正誤判定ができ、正解時にスコア（残りパネル数）が確定する
- リセットでその問題の状態が初期状態に戻る
